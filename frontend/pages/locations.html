<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Locations</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <link rel="stylesheet" type="text/css" href="restaurantPage.css" />
  </head>
  <body>
    <header>
      <img id="logo" src="img/pomonalogo.png" />

      <h1>CPP Campus Food & Delivery</h1>

      <p class="underLogo">
        <strong>Locations</strong>
      </p>

      <img id="accountImage" src="img/billybronco.png" onclick="switchToAccountPage()"/>
    </header>

    <div id="location-list"></div>

    <script>
        function switchToAccountPage() {
          window.location.href = "accountPage.html";
        }

        if (!localStorage.getItem("userId")) {
            window.location.href = "login.html"; 
        }
      // Function to fetch location data from the API
      function fetchLocations() {
            fetch("http://localhost:5555/locations")
                .then((response) => response.json())
                .then((data) => {
                    const locations = Object.entries(data);
                    const locationList = document.getElementById("location-list");

                    // Clear the location list before adding new entries
                    locationList.innerHTML = '';

                    // Iterate over location data and create HTML elements
                    locations.forEach(([buildingNumber, rooms]) => {
                        const locationDiv = document.createElement("div");
                        locationDiv.classList.add("restaurant-item");

                        const buildingHeader = document.createElement("h2");
                        buildingHeader.textContent = `Building ${buildingNumber}`;
                        locationDiv.appendChild(buildingHeader);

                        const roomsList = document.createElement("ul");
                        rooms.forEach(({ id, roomNumber }) => {
                            const roomItem = document.createElement("li");
                            roomItem.textContent = `Room ${roomNumber} = ${id}`;
                            roomsList.appendChild(roomItem);
                        });

                        locationDiv.appendChild(buildingHeader);
                        locationDiv.appendChild(roomsList);
                        locationList.appendChild(locationDiv);
                    });
                })
                .catch((error) => {
                    console.error("Error fetching location data:", error);
                });
        }

      // Call fetchLocations function when the page loads
      window.onload = fetchLocations;
    </script>
    
  </body>
</html>
